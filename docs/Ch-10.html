<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.8.23">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">

<meta name="description" content="Lecture Notes for module MA-M27">

<title>10&nbsp; Data Reduction – MA-M27 Probability and Statistics for Data Science</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
</style>


<script src="site_libs/quarto-nav/quarto-nav.js"></script>
<script src="site_libs/quarto-nav/headroom.min.js"></script>
<script src="site_libs/clipboard/clipboard.min.js"></script>
<script src="site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="site_libs/quarto-search/fuse.min.js"></script>
<script src="site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="./">
<link href="./Ch-09.html" rel="prev">
<script src="site_libs/quarto-html/quarto.js" type="module"></script>
<script src="site_libs/quarto-html/tabsets/tabsets.js" type="module"></script>
<script src="site_libs/quarto-html/axe/axe-check.js" type="module"></script>
<script src="site_libs/quarto-html/popper.min.js"></script>
<script src="site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="site_libs/quarto-html/anchor.min.js"></script>
<link href="site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="site_libs/quarto-html/quarto-syntax-highlighting-1fe81d0376b2c50856e68e651e390326.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="site_libs/bootstrap/bootstrap.min.js"></script>
<link href="site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="site_libs/bootstrap/bootstrap-ac3a3105c226c7986a7d0fc1c9f8a330.min.css" rel="stylesheet" append-hash="true" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "sidebar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "start",
  "type": "textbox",
  "limit": 50,
  "keyboard-shortcut": [
    "f",
    "/",
    "s"
  ],
  "show-item-context": false,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-text-placeholder": "",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>

  <script src="https://cdnjs.cloudflare.com/polyfill/v3/polyfill.min.js?features=es6"></script>
  <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script>

<script type="text/javascript">
const typesetMath = (el) => {
  if (window.MathJax) {
    // MathJax Typeset
    window.MathJax.typeset([el]);
  } else if (window.katex) {
    // KaTeX Render
    var mathElements = el.getElementsByClassName("math");
    var macros = [];
    for (var i = 0; i < mathElements.length; i++) {
      var texText = mathElements[i].firstChild;
      if (mathElements[i].tagName == "SPAN" && texText && texText.data) {
        window.katex.render(texText.data, mathElements[i], {
          displayMode: mathElements[i].classList.contains('display'),
          throwOnError: false,
          macros: macros,
          fleqn: false
        });
      }
    }
  }
}
window.Quarto = {
  typesetMath
};
</script>

<link rel="stylesheet" href="styles.css">
<meta property="og:title" content="10&nbsp; Data Reduction – MA-M27 Probability and Statistics for Data Science">
<meta property="og:description" content="Lecture Notes for module MA-M27">
<meta property="og:site_name" content="MA-M27 Probability and Statistics for Data Science">
</head>

<body class="nav-sidebar floating fullcontent quarto-light">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
  <nav class="quarto-secondary-nav">
    <div class="container-fluid d-flex">
      <button type="button" class="quarto-btn-toggle btn" data-bs-toggle="collapse" role="button" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
        <i class="bi bi-layout-text-sidebar-reverse"></i>
      </button>
        <nav class="quarto-page-breadcrumbs" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="./Ch-10.html"><span class="chapter-number">10</span>&nbsp; <span class="chapter-title">Data Reduction</span></a></li></ol></nav>
        <a class="flex-grow-1" role="navigation" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">      
        </a>
      <button type="button" class="btn quarto-search-button" aria-label="Search" onclick="window.quartoOpenSearch();">
        <i class="bi bi-search"></i>
      </button>
    </div>
  </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse collapse-horizontal quarto-sidebar-collapse-item sidebar-navigation floating overflow-auto">
    <div class="pt-lg-2 mt-2 text-left sidebar-header sidebar-header-stacked">
      <a href="./index.html" class="sidebar-logo-link">
      </a>
    <div class="sidebar-title mb-0 py-0">
      <a href="./">MA-M27 Probability and Statistics for Data Science</a> 
    </div>
      </div>
        <div class="mt-2 flex-shrink-0 align-items-center">
        <div class="sidebar-search">
        <div id="quarto-search" class="" title="Search"></div>
        </div>
        </div>
    <div class="sidebar-menu-container"> 
    <ul class="list-unstyled mt-1">
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Introduction</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./Ch-01.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">1</span>&nbsp; <span class="chapter-title">Basic Concepts in Statistics</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./Ch-02.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">2</span>&nbsp; <span class="chapter-title">Basic Concepts and Rules of Probability</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./Ch-03.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">3</span>&nbsp; <span class="chapter-title">Discrete Probability Distributions</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./Ch-04.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">4</span>&nbsp; <span class="chapter-title">Linear Regression and Correlation, Logistic Regression</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./Ch-05.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">5</span>&nbsp; <span class="chapter-title">Continuous Probability Distributions</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./Ch-06.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">6</span>&nbsp; <span class="chapter-title">Law of large numbers and the central limit theorem</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./Ch-07.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">7</span>&nbsp; <span class="chapter-title">Hypothesis Testing: <span class="math inline">\(Z\)</span>-tests and <span class="math inline">\(t\)</span>-tests</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./Ch-08.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">8</span>&nbsp; <span class="chapter-title">Maximum likelihood estimation</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./Ch-09.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">9</span>&nbsp; <span class="chapter-title">Time series</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./Ch-10.html" class="sidebar-item-text sidebar-link active">
 <span class="menu-text"><span class="chapter-number">10</span>&nbsp; <span class="chapter-title">Data Reduction</span></span></a>
  </div>
</li>
    </ul>
    </div>
</nav>
<div id="quarto-sidebar-glass" class="quarto-sidebar-collapse-item" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item"></div>
<!-- margin-sidebar -->
    
<!-- main -->
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title"><span class="chapter-number">10</span>&nbsp; <span class="chapter-title">Data Reduction</span></h1>
</div>



<div class="quarto-title-meta">

    
  
    
  </div>
  


</header>


<p><span class="math display">\[  
\renewcommand{\P}{\mathbb{P}}  
\renewcommand{\E}{\mathbb{E}}  
\newcommand{\R}{\mathbb{R}}  
\newcommand{\var}{\mathrm{Var}}  
\newcommand{\cov}{\mathrm{cov}}  
\newcommand{\corr}{\mathrm{corr}}
\newcommand{\dx}{\,\mathrm{d}x}
\newcommand{\dy}{\,\mathrm{d}y}
\newcommand{\eps}{\varepsilon}
\]</span></p>
<p>A useful resource for this chapter is <em>Using Multivariate Statistics</em> by B.G.Tabachnick and L.S.Fidell. The material taught in this chapter will be met from a machine learning perspective in <em>MA-M28 Modelling and Machine Learning</em> — please see chapter 4 of <em>Essential Math for Data Science</em> if you would like an insight into this.</p>
<p>Factor Analysis (FA) and Principal Component Analysis (PCA) are statistical techniques applied to a (large) set of variables to try to reduce them into subsets of relatively independent variables. Such subsets contain variables that are correlated with one another, but largely independent of other subsets of variables and are combined into factors (or components in PCA).</p>
<p>Therefore, the idea of FA and PCA is to summarise patterns of correlations among observed variables and then to use this information to reduce a large number of observed variables to a smaller number of factors. A good FA or PCA makes sense, a bad one does not, therefore a good understanding of the data is required.</p>
<section id="exploratory-factor-analysis" class="level2" data-number="10.1">
<h2 data-number="10.1" class="anchored" data-anchor-id="exploratory-factor-analysis"><span class="header-section-number">10.1</span> (Exploratory) Factor Analysis</h2>
<p>In Factor Analysis, the subsets of variables are unobservable <strong>latent variables</strong> — we cannot measure them directly. Examples of such variables could be intelligence or social class. We could try to measure such concepts indirectly, for example by measuring occupation, salary and value of home for social class.</p>
<p>Mathematically, the technique involves representing the original variables as a linear combination of the “hidden” factors and an error term. If <span class="math inline">\(Y_1,Y_2,\ldots,Y_n\)</span> represent the <span class="math inline">\(n\)</span> observed variables with means <span class="math inline">\(\mu_1,\ldots,\mu_n\)</span>, and <span class="math inline">\(F_1,\ldots,F_m\)</span> represent the “hidden” <span class="math inline">\(m\)</span> factors, then we may consider the centralised observations <span class="math inline">\(X_i=Y_i-\mu_i\)</span> as follows: <span id="eq-FullLinearModel"><span class="math display">\[
\begin{aligned}
X_1=Y_1-\mu_1&amp;=a_{11}F_1+a_{12}F_2+\cdots+a_{1m}F_m+\epsilon_1\\
X_2=Y_2-\mu_2&amp;=a_{21}F_1+a_{22}F_2+\cdots+a_{2m}F_m+\epsilon_2\\
\vdots&amp;\hskip2cm\vdots\hskip2cm\vdots\\
X_n=Y_n-\mu_n&amp;=a_{n1}F_1+a_{n2}F_2+\cdots+a_{nm}F_m+\epsilon_n,
\end{aligned}
\tag{10.1}\]</span></span></p>
<p>where <span class="math inline">\(a_{ij}\)</span> represents the <strong>factor loading</strong> of the <span class="math inline">\(i^{\text{th}}\)</span> variable on the <span class="math inline">\(j^{\text{th}}\)</span> factor and <span class="math inline">\(\epsilon_i\)</span> represents the error or unique specific factor. We assume that <span class="math inline">\(\epsilon_i\)</span> has 0 mean and specific variance <span class="math inline">\(\psi_i\)</span>. In matrix notation, this can be represented as, <span id="eq-LinearModel"><span class="math display">\[
X=AF+\epsilon.
\tag{10.2}\]</span></span></p>
<p>Consider the following illustrative example.</p>
<div id="exm-experiment" class="theorem example">
<p><span class="theorem-title"><strong>Example 10.1</strong></span> In an experiment, 200 primary school children were psychologically tested. The children were tested on the following (the observed variables):</p>
<ul>
<li><p>Paragraph comprehension (<span class="math inline">\(X_1\)</span>);</p></li>
<li><p>Sentence completion (<span class="math inline">\(X_2\)</span>);</p></li>
<li><p>Word meaning (<span class="math inline">\(X_3\)</span>);</p></li>
<li><p>Addition (<span class="math inline">\(X_4\)</span>);</p></li>
<li><p>Counting (<span class="math inline">\(X_5\)</span>).</p></li>
</ul>
<p>A factor analysis gives the following linear combinations: <span class="math display">\[
\begin{aligned}
X_1&amp;=0.81F_1+0.06F_2+\epsilon_1\\
X_2&amp;=0.72F_1+0.08F_2+\epsilon_2\\
X_3&amp;=0.91F_1+0.01F_2+\epsilon_3\\
X_4&amp;=0.02F_1+0.69F_2+\epsilon_4\\
X_5&amp;=0.11F_1+0.92F_2+\epsilon_5
\end{aligned}
\]</span> Clearly, variables <span class="math inline">\(X_1,X_2\)</span> and <span class="math inline">\(X_3\)</span> have a high factor loading with <span class="math inline">\(F_1\)</span> and a low factor loading with <span class="math inline">\(F_2\)</span>. Variables <span class="math inline">\(X_4\)</span> and <span class="math inline">\(X_5\)</span> have a low factor loading with <span class="math inline">\(F_1\)</span> and a high factor loading with <span class="math inline">\(F_2\)</span>. This suggests that <span class="math inline">\(F_1\)</span> is the factor, or latent variable, <strong>literacy skills</strong> and <span class="math inline">\(F_2\)</span> is the factor, or latent variable, <strong>numeracy skills</strong>.</p>
</div>
<p>This gives a general insight into the method. We now consider the finer details of the procedure, in particular, we will investigate the methods of calculating factor loadings and determining factors. We first consider/recall the definition of the covariance of random variables, <span class="math display">\[
\begin{aligned}
\cov(X,Y)&amp;=\E((X-\E(X))(Y-\E(Y)))\\
&amp;=\E(XY-\E(X)Y-X\E(Y)+\E(X)\E(Y))\\
&amp;=\E(XY)-\E(X)\E(Y)-\E(X)\E(Y)+\E(X)\E(Y)\\
&amp;=\E(XY)-\E(X)\E(Y).\\
\end{aligned}
\]</span> For matrices, this generalises to, <span id="eq-Sigma"><span class="math display">\[
\Sigma=\E\left[(X-\E(X))(X-\E(X))^T\right].
\tag{10.3}\]</span></span></p>
<p>Since the <span class="math inline">\(X_i\)</span>’s are centralised in our calculations, <span class="math inline">\(\E(X)=0\)</span> in the linear model (<a href="#eq-LinearModel" class="quarto-xref"><span>10.2</span></a>), and we obtain <span class="math inline">\(\Sigma\)</span>, the covariance matrix of the variables <span class="math inline">\(X_1,\ldots,X_n\)</span>, as follows: <span class="math display">\[
\Sigma=\E(XX^T),
\]</span> by (<a href="#eq-Sigma" class="quarto-xref"><span>10.3</span></a>) with <span class="math inline">\(\E(X)=0\)</span>, and by (<a href="#eq-LinearModel" class="quarto-xref"><span>10.2</span></a>), <span class="math display">\[
\begin{aligned}
\E(XX^T) &amp;= \E((AF+\epsilon)(AF+\epsilon)^T)\\
&amp;=\E((AF+\epsilon)(F^TA^T+\epsilon^T))\\
&amp;=\E(AFF^TA^T)+A\E(F\epsilon^T)+\E(\epsilon F^T)A^T+\E(\epsilon\epsilon^T)\\
&amp;=AIA^T+0+0+\Psi\\
&amp;=AA^T+\Psi,
\end{aligned}
\]</span> where <span class="math inline">\(\Psi\)</span> is a diagonal matrix of the specific variances <span class="math inline">\(\psi_i\)</span>. We assume that the factors are uncorrelated with unit variance, hence <span class="math inline">\(\E(FF^T)=I\)</span> above. Also, the cross-multiplication terms are 0 since we assume that the factors are not correlated with the errors <span class="math inline">\(\epsilon\)</span>. Note that the factors themselves have now dropped out of the calculations. Next we set, <span class="math display">\[
R=AA^T=\Sigma-\Psi,
\]</span> where <span class="math inline">\(R\)</span> is known as the adjusted covariance matrix, i.e.&nbsp;the variance of the observations are “adjusted” by subtracting the specific variances. Like <span class="math inline">\(\Sigma\)</span>, <span class="math inline">\(R\)</span> is a symmetric matrix and hence using results from linear algebra we may state <span class="math display">\[
R=VLV^T,
\]</span> where <span class="math inline">\(V\)</span> is a matrix of the eigenvectors of <span class="math inline">\(R\)</span> and <span class="math inline">\(L\)</span> a matrix of the eigenvalues of <span class="math inline">\(R\)</span>. Furthermore, <span class="math display">\[
\begin{aligned}
R=VLV^T&amp;=V\sqrt{L}\sqrt{L}V^T\\
&amp;=(V\sqrt{L})(\sqrt{L}V^T)\\
&amp;=(V\sqrt{L})(V\sqrt{L})^T\\
&amp;=AA^T,
\end{aligned}
\]</span> where we used that <span class="math inline">\(L\)</span> is diagonal, hence <span class="math inline">\(\sqrt{L}^T=\sqrt{L}\)</span>. This implies that <span id="eq-CovMatrix"><span class="math display">\[
A=V\sqrt{L}.
\tag{10.4}\]</span></span> Therefore, once the eigenvectors and eigenvalues of <span class="math inline">\(R\)</span> are known, the factor loading matrix <span class="math inline">\(A\)</span> is easily obtained by (<a href="#eq-CovMatrix" class="quarto-xref"><span>10.4</span></a>).</p>
<div class="callout callout-style-default callout-tip no-icon callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-title-container flex-fill">
<span class="screen-reader-only">Tip</span>Remark 10.2
</div>
</div>
<div class="callout-body-container callout-body">
<p>Note that equation (<a href="#eq-CovMatrix" class="quarto-xref"><span>10.4</span></a>) is true if all factors, or eigenvalues, are used in the model. However, we only want to consider significant factors (i.e.&nbsp;we may choose to ignore certain factors) and therefore we require methods of extracting and evaluating such factors.</p>
</div>
</div>
<p>In Python, there are various methods of “extracting” the factors, the main one being <strong>Principle Axis Factoring</strong> which finds the least number of factors that account for the common variance of a set of variables.</p>
<section id="evaluating-factors" class="level3 unnumbered">
<h3 class="unnumbered anchored" data-anchor-id="evaluating-factors">Evaluating Factors</h3>
<p>There are various means of evaluating and extracting the factors, including:</p>
<ul>
<li><p><strong>Eigenvalues:</strong> one method of choosing factors is to consider factors with eigenvalues <span class="math inline">\(&gt;1\)</span>. This is known as the <strong>Kaiser criterion</strong>.</p></li>
<li><p><strong>Scree plot:</strong> this is a plot of the eigenvalues which can indicate where there is a clear cut-off (an inflexion point) between large and small eigenvalues.</p></li>
<li><p><strong>Communality:</strong> this is the sum of the squared loadings for a variable across factors and it provides a percentage of variance accounted for by the factors. The accepted proportions for communality are dependent on the sample size. The general rule is as follows:</p>
<ul>
<li><p>If all communalities <span class="math inline">\(&gt;0.6\)</span>, then this is considered very strong and we may even take relatively small samples in this scenario (<span class="math inline">\(&lt; 100\)</span>);</p></li>
<li><p>Communalities <span class="math inline">\(&gt;0.5\)</span> are adequate for sample of size <span class="math inline">\(100-200\)</span>, or more;</p></li>
<li><p>Smaller communalities may be accepted for larger sample sizes.</p></li>
</ul></li>
<li><p><strong>Factor loadings:</strong> we aim for factor loadings to be <span class="math inline">\(\geq0.4\)</span> for the main factor. We then study the observations with high loadings of a particular factor in order to try to identify the factor. Factor loadings appear in the <strong>Pattern Matrix</strong> in Python.</p></li>
</ul>
</section>
<section id="rotations" class="level3 unnumbered">
<h3 class="unnumbered anchored" data-anchor-id="rotations">Rotations</h3>
<p>In cases where the factor loading matrix <span class="math inline">\(A\)</span> cannot be interpreted clearly, it may be rotated to try to improve interpretations. The aim is to maximise high correlations between factors and variables and to minimise low ones. This can be performed since the factor loading matrix is not uniquely defined. There are two different types of rotation, orthogonal and oblique.</p>
</section>
<section id="orthogonal-rotations" class="level3 unnumbered">
<h3 class="unnumbered anchored" data-anchor-id="orthogonal-rotations">Orthogonal Rotations</h3>
<p>Orthogonal rotations are used when we assume that the factors are uncorrelated. There are various orthogonal rotations possible, with the most common being <strong>Varimax</strong>, <strong>Quartimax</strong> and <strong>Equamax</strong>. The process involves a simple matrix multiplication as follows: <span id="eq-rot"><span class="math display">\[
A_{\text{rotated}}=A\Lambda,
\tag{10.5}\]</span></span> where <span class="math inline">\(\Lambda\)</span> is the rotation matrix, <span id="eq-rotmat"><span class="math display">\[
\begin{pmatrix}
\cos\theta &amp;-\sin\theta\\
\sin\theta&amp;\cos\theta
\end{pmatrix}.
\tag{10.6}\]</span></span> For the case where we have 2 factors, a typical orthogonal rotation is illustrated as follows:</p>
<p></p>
</section>
<section id="varimax-rotation" class="level3 unnumbered">
<h3 class="unnumbered anchored" data-anchor-id="varimax-rotation">Varimax Rotation</h3>
<p>Varimax is often the most common used rotation which involves a variance maximising procedure. The goal of varimax rotation is to maximise the variance of factor loadings by making high loadings higher and low ones lower for each factor.</p>
</section>
<section id="quartimax-rotation" class="level3 unnumbered">
<h3 class="unnumbered anchored" data-anchor-id="quartimax-rotation">Quartimax Rotation</h3>
<p>Quartimax does for variables what varimax does for factors. It simplifies variables by increasing the dispersion of the loadings within variables, across factors.</p>
</section>
<section id="equamax-rotation" class="level3 unnumbered">
<h3 class="unnumbered anchored" data-anchor-id="equamax-rotation">Equamax Rotation</h3>
<p>Equamax rotation is a hybrid between varimax and quartimax that tries simultaneously to simplify the factors and the variables.</p>
<p>In conclusion, varimax rotation simplifies the factors, quartimax the variables and equamax both.</p>
</section>
<section id="oblique-rotation" class="level3 unnumbered">
<h3 class="unnumbered anchored" data-anchor-id="oblique-rotation">Oblique Rotation</h3>
<p>Oblique rotations allow the factors to be correlated. In practice, this is a highly likely possibility. For example, if two of our factors were Achievement and Alcoholism, we would expect there to be a correlation between these factors. Oblique rotations also include orthogonal rotations, i.e.&nbsp;when the factors are assumed to be uncorrelated. For the case where we have 2 factors, a typical oblique rotation is illustrated as follows:</p>
<p></p>
<p>The two main types of oblique rotations are Direct Oblimin and Promax.</p>
<p>Direct Oblimin is the default oblique rotation we will use in Python.</p>
<p>The Promax method is quicker and is therefore better to use if dealing with large data sets.</p>
<p>It is good practice to first perform an oblique rotation and to change to an orthogonal rotation if correlation between the factors does not seem to exist. In Python, this can be checked by examining the <strong>Factor Correlation Matrix</strong> <span class="math inline">\(\Phi\)</span>, which is given by, <span class="math display">\[
\Phi=\begin{pmatrix}
\phi_{11} &amp; \phi_{12} &amp;\cdots&amp;\phi_{1m}\\
\phi_{21}&amp;\phi_{22}&amp;\cdots&amp;\phi_{2m}\\
\vdots&amp; &amp; \vdots&amp;\\
\phi_{m1}&amp;\phi_{m2}&amp;\cdots&amp;\phi_{mm}
\end{pmatrix},
\]</span> where <span class="math inline">\(m\)</span> is the number of factors.</p>
<p>The general rule is to use an oblique rotation if <span class="math inline">\(|\phi_{ij}|&gt; 0.32\)</span> for all <span class="math inline">\(i,j=1,\ldots,m, i\neq j\)</span>. Clearly, we do not include the diagonal terms as these will always be 1 (i.e.&nbsp;the correlation of a factor with itself).</p>
<p>If an oblique rotation is found to be suitable, the elements of the <strong>Pattern Matrix</strong> are reported.</p>
<p>The following example is for illustrative purposes only.</p>
<div id="exm-unnamed" class="theorem example">
<p><span class="theorem-title"><strong>Example 10.3</strong></span> In an experiment, skiers were asked about their opinions on the cost of a skiing ticket (COST), the speed of the ski lifts (LIFT), the depth of the snow (DEPTH) and the moisture of snow (POWDER). Here is the raw data,</p>
<table class="caption-top table">
<thead>
<tr class="header">
<th style="text-align: center;">Skier</th>
<th style="text-align: center;">COST</th>
<th style="text-align: center;">LIFT</th>
<th style="text-align: center;">DEPTH</th>
<th style="text-align: center;">POWDER</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: center;"><span class="math inline">\(S_1\)</span></td>
<td style="text-align: center;">32</td>
<td style="text-align: center;">64</td>
<td style="text-align: center;">65</td>
<td style="text-align: center;">67</td>
</tr>
<tr class="even">
<td style="text-align: center;"><span class="math inline">\(S_2\)</span></td>
<td style="text-align: center;">61</td>
<td style="text-align: center;">37</td>
<td style="text-align: center;">62</td>
<td style="text-align: center;">65</td>
</tr>
<tr class="odd">
<td style="text-align: center;"><span class="math inline">\(S_3\)</span></td>
<td style="text-align: center;">59</td>
<td style="text-align: center;">40</td>
<td style="text-align: center;">45</td>
<td style="text-align: center;">43</td>
</tr>
<tr class="even">
<td style="text-align: center;"><span class="math inline">\(S_4\)</span></td>
<td style="text-align: center;">36</td>
<td style="text-align: center;">62</td>
<td style="text-align: center;">34</td>
<td style="text-align: center;">35</td>
</tr>
<tr class="odd">
<td style="text-align: center;"><span class="math inline">\(S_5\)</span></td>
<td style="text-align: center;">62</td>
<td style="text-align: center;">46</td>
<td style="text-align: center;">43</td>
<td style="text-align: center;">40</td>
</tr>
</tbody>
</table>
<p>When no limit is placed on the number of factors, we have 4 factors with eigenvalues 2.02, 1.94, 0.04 and 0.00. Using the Kaiser criterion and a scree plot, we keep the eigenvalues 2.02 and 1.94, and then we run the factor analysis again with these 2 factors only. Below is the scree plot that shows a clear distinction between the eigenvalues:</p>
<p></p>
Once we run the analysis keeping only the 2 strong factors, we obtain the communalities under the <strong>extraction</strong> column in the table below:
Clearly, as these communalities are close to 1, a large proportion of the variation in each variable can be accounted for by the factors. The pattern matrix is given by,
We see that DEPTH and POWDER have a high factor loading with Factor 1 and that COST and LIFT have a high factor loading with Factor 2. However, since the remaining factor loadings are not negligible, we will perform rotations with the aim of obtaining a clearer interpretation. Firstly, let us consider the Direct Oblimin oblique rotation. The Factor Correlation Matrix <span class="math inline">\(\Phi\)</span> is given below,
We can see that <span class="math inline">\(|\phi_{ij}|\leq 0.32\)</span> for <span class="math inline">\(i\neq j\)</span>. Therefore, we conclude that an oblique rotation is not warranted and instead we use the Varimax orthogonal rotation,
This is a rotation in the sense of (<a href="#eq-rotmat" class="quarto-xref"><span>10.6</span></a>) by 0.33 radians (19 degrees). Using (<a href="#eq-rot" class="quarto-xref"><span>10.5</span></a>), we can confirm the rotated factors are given by: <span class="math display">\[
\begin{aligned}
A_{\text{rotated}}=A\Lambda&amp;=\begin{pmatrix}
-.40 &amp; .90\\
.25&amp;-.95\\
.93&amp;.35\\
.96&amp;.29
\end{pmatrix}\begin{pmatrix} \cos0.33 &amp;-\sin0.33\\ \sin0.33 &amp;\cos0.33     \end{pmatrix}\\
&amp;=\begin{pmatrix}
-.40 &amp; .90\\
.25&amp;-.95\\
.93&amp;.35\\
.96&amp;.29
\end{pmatrix}\begin{pmatrix} .95 &amp;-.33\\ .33 &amp;.95     \end{pmatrix}\\
&amp;=\begin{pmatrix}
-.08&amp;.98\\-.08&amp;-.98\\.99&amp;.02\\1&amp;.05
\end{pmatrix}
\end{aligned}
\]</span> Here is an illustration of the rotation:
<p>In this example, it is clear that the variables DEPTH and POWDER are associated with a factor concerning snow conditions. The variables COST and LIFT are associated with a factor concerning resort conditions.</p>
</div>
</section>
</section>
<section id="principal-component-analysis-pca" class="level2" data-number="10.2">
<h2 data-number="10.2" class="anchored" data-anchor-id="principal-component-analysis-pca"><span class="header-section-number">10.2</span> Principal Component Analysis (PCA)</h2>
<p>Principal component analysis is similar to factor analysis in that both are used for data reduction, and they often provide similar results. However, in PCA we write the components (factors in FA) as a linear combination of the variables, where as in FA, we write the variables in terms of the factors, see (<a href="#eq-FullLinearModel" class="quarto-xref"><span>10.1</span></a>). This can be expressed as follows: <span class="math display">\[
\begin{aligned}
C_1&amp;=e_{11}X_1+e_{12}X_2+\cdots+e_{1n}X_n\\
C_2&amp;=e_{21}X_1+e_{22}X_2+\cdots+e_{2n}X_n\\
\vdots&amp;\hskip2cm\vdots\\
C_m&amp;=e_{m1}X_1+e_{m2}X_2+\cdots+e_{mn}X_n,
\end{aligned}
\]</span> where <span class="math inline">\(C_1,\ldots, C_m\)</span> represent the components, <span class="math inline">\(X_1,\ldots, X_n\)</span> are the variables and <span class="math inline">\(e_{ij}\)</span> are the regression coefficients, or weights of the variables. Similar to (<a href="#eq-LinearModel" class="quarto-xref"><span>10.2</span></a>), we can rewrite this system in matrix form as below, <span class="math display">\[
C=EX.
\]</span> In the case of factor analysis, the factor loadings were given by the eigenvectors and eigenvalues, however, in principal component analysis, the weightings of the variables are given by the eigenvectors and eigenvalues of the covariance matrix. The largest eigenvalue and associated eigenvector is applied to the first principal component, with the next largest applied to the second principal component etc.</p>
<section id="choosing-principal-components" class="level3 unnumbered">
<h3 class="unnumbered anchored" data-anchor-id="choosing-principal-components">Choosing Principal Components</h3>
<p>The principal components are chosen in the following way:</p>
<ul>
<li><p>The first principal component, <span class="math display">\[
C_1=e_{11}X_1+e_{12}X_2+\cdots+e_{1n}X_n,
\]</span> is chosen such that it accounts for as much variation in the data as possible, subject to the condition that <span class="math inline">\(e_{11}^2+e_{12}^2+\ldots e_{1n}^2=1\)</span>.</p></li>
<li><p>The second, <span class="math display">\[
C_2=e_{21}X_1+e_{22}X_2+\cdots+e_{2n}X_n,
\]</span> is chosen such that the variance is as high as possible, similarly conditional on <span class="math inline">\(e_{21}^2+e_{22}^2+\ldots e_{2n}^2=1\)</span>.</p></li>
<li><p>The second principal component must be chosen such that it is <strong>uncorrelated</strong> with the first.</p></li>
<li><p>The <span class="math inline">\(i^{\text{th}}\)</span> principal component, <span class="math display">\[
C_i=e_{i1}X_1+e_{i2}X_2+\cdots+e_{in}X_n,
\]</span> again is chosen such that the variance is as high as possible, conditional on <span class="math inline">\(e_{i1}^2+e_{i2}^2+\ldots e_{in}^2=1\)</span> and it being uncorrelated with all other principal components.</p></li>
<li><p>All principal components are uncorrelated with each other.</p></li>
</ul>
<p>As previously stated, the weightings <span class="math inline">\(e_{ij}\)</span> are obtained from eigenvectors corresponding to the <span class="math inline">\(i^{\text{th}}\)</span> largest eigenvalue.</p>
<div class="callout callout-style-default callout-tip no-icon callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-title-container flex-fill">
<span class="screen-reader-only">Tip</span>Remark 10.4
</div>
</div>
<div class="callout-body-container callout-body">
<p>The process of maximising the variance uses the theory of Constrained Optimisation, which, in this case, essentially means maximising the variance for the <span class="math inline">\(i^{\text{th}}\)</span> principal component conditional on <span class="math inline">\(e_{i1}^2+e_{i2}^2+\ldots e_{in}^2=1\)</span>.</p>
</div>
</div>
</section>
<section id="number-of-components-and-rotations" class="level3 unnumbered">
<h3 class="unnumbered anchored" data-anchor-id="number-of-components-and-rotations">Number of Components and Rotations</h3>
<p>We will use the same guidelines for determining the number of components as we did for factors in factor analysis, i.e.&nbsp;by evaluating eigenvalues, scree plots, communalities and factor loadings. Similarly, we will use rotations in the same way for principal component analysis as we did in factor analysis, i.e.&nbsp;if components are not clear from the unrotated results, we next perform an oblique rotation. If there is not enough correlation between the principal components to warrant the use of an oblique rotation, we then perform an orthogonal rotation.</p>
</section>
<section id="deciding-between-pca-and-fa" class="level3 unnumbered">
<h3 class="unnumbered anchored" data-anchor-id="deciding-between-pca-and-fa">Deciding between PCA and FA</h3>
<p>PCA is used to simply reduce the observed variables into a smaller set of important independent composite variables (components). FA tends to be used when there are suspected latent factors (not directly measurable factors) causing the observed variables.</p>


</section>
</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
  window.document.addEventListener("DOMContentLoaded", function (event) {
    const icon = "";
    const anchorJS = new window.AnchorJS();
    anchorJS.options = {
      placement: 'right',
      icon: icon
    };
    anchorJS.add('.anchored');
    const isCodeAnnotation = (el) => {
      for (const clz of el.classList) {
        if (clz.startsWith('code-annotation-')) {                     
          return true;
        }
      }
      return false;
    }
    const onCopySuccess = function(e) {
      // button target
      const button = e.trigger;
      // don't keep focus
      button.blur();
      // flash "checked"
      button.classList.add('code-copy-button-checked');
      var currentTitle = button.getAttribute("title");
      button.setAttribute("title", "Copied!");
      let tooltip;
      if (window.bootstrap) {
        button.setAttribute("data-bs-toggle", "tooltip");
        button.setAttribute("data-bs-placement", "left");
        button.setAttribute("data-bs-title", "Copied!");
        tooltip = new bootstrap.Tooltip(button, 
          { trigger: "manual", 
            customClass: "code-copy-button-tooltip",
            offset: [0, -8]});
        tooltip.show();    
      }
      setTimeout(function() {
        if (tooltip) {
          tooltip.hide();
          button.removeAttribute("data-bs-title");
          button.removeAttribute("data-bs-toggle");
          button.removeAttribute("data-bs-placement");
        }
        button.setAttribute("title", currentTitle);
        button.classList.remove('code-copy-button-checked');
      }, 1000);
      // clear code selection
      e.clearSelection();
    }
    const getTextToCopy = function(trigger) {
      const outerScaffold = trigger.parentElement.cloneNode(true);
      const codeEl = outerScaffold.querySelector('code');
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
    }
    const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
      text: getTextToCopy
    });
    clipboard.on('success', onCopySuccess);
    if (window.document.getElementById('quarto-embedded-source-code-modal')) {
      const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
        text: getTextToCopy,
        container: window.document.getElementById('quarto-embedded-source-code-modal')
      });
      clipboardModal.on('success', onCopySuccess);
    }
      var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
      var mailtoRegex = new RegExp(/^mailto:/);
        var filterRegex = new RegExp('/' + window.location.host + '/');
      var isInternal = (href) => {
          return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
      }
      // Inspect non-navigation links and adorn them if external
     var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
      for (var i=0; i<links.length; i++) {
        const link = links[i];
        if (!isInternal(link.href)) {
          // undo the damage that might have been done by quarto-nav.js in the case of
          // links that we want to consider external
          if (link.dataset.originalHref !== undefined) {
            link.href = link.dataset.originalHref;
          }
        }
      }
    function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
      const config = {
        allowHTML: true,
        maxWidth: 500,
        delay: 100,
        arrow: false,
        appendTo: function(el) {
            return el.parentElement;
        },
        interactive: true,
        interactiveBorder: 10,
        theme: 'quarto',
        placement: 'bottom-start',
      };
      if (contentFn) {
        config.content = contentFn;
      }
      if (onTriggerFn) {
        config.onTrigger = onTriggerFn;
      }
      if (onUntriggerFn) {
        config.onUntrigger = onUntriggerFn;
      }
      window.tippy(el, config); 
    }
    const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
    for (var i=0; i<noterefs.length; i++) {
      const ref = noterefs[i];
      tippyHover(ref, function() {
        // use id or data attribute instead here
        let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
        try { href = new URL(href).hash; } catch {}
        const id = href.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note) {
          return note.innerHTML;
        } else {
          return "";
        }
      });
    }
    const xrefs = window.document.querySelectorAll('a.quarto-xref');
    const processXRef = (id, note) => {
      // Strip column container classes
      const stripColumnClz = (el) => {
        el.classList.remove("page-full", "page-columns");
        if (el.children) {
          for (const child of el.children) {
            stripColumnClz(child);
          }
        }
      }
      stripColumnClz(note)
      if (id === null || id.startsWith('sec-')) {
        // Special case sections, only their first couple elements
        const container = document.createElement("div");
        if (note.children && note.children.length > 2) {
          container.appendChild(note.children[0].cloneNode(true));
          for (let i = 1; i < note.children.length; i++) {
            const child = note.children[i];
            if (child.tagName === "P" && child.innerText === "") {
              continue;
            } else {
              container.appendChild(child.cloneNode(true));
              break;
            }
          }
          if (window.Quarto?.typesetMath) {
            window.Quarto.typesetMath(container);
          }
          return container.innerHTML
        } else {
          if (window.Quarto?.typesetMath) {
            window.Quarto.typesetMath(note);
          }
          return note.innerHTML;
        }
      } else {
        // Remove any anchor links if they are present
        const anchorLink = note.querySelector('a.anchorjs-link');
        if (anchorLink) {
          anchorLink.remove();
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        if (note.classList.contains("callout")) {
          return note.outerHTML;
        } else {
          return note.innerHTML;
        }
      }
    }
    for (var i=0; i<xrefs.length; i++) {
      const xref = xrefs[i];
      tippyHover(xref, undefined, function(instance) {
        instance.disable();
        let url = xref.getAttribute('href');
        let hash = undefined; 
        if (url.startsWith('#')) {
          hash = url;
        } else {
          try { hash = new URL(url).hash; } catch {}
        }
        if (hash) {
          const id = hash.replace(/^#\/?/, "");
          const note = window.document.getElementById(id);
          if (note !== null) {
            try {
              const html = processXRef(id, note.cloneNode(true));
              instance.setContent(html);
            } finally {
              instance.enable();
              instance.show();
            }
          } else {
            // See if we can fetch this
            fetch(url.split('#')[0])
            .then(res => res.text())
            .then(html => {
              const parser = new DOMParser();
              const htmlDoc = parser.parseFromString(html, "text/html");
              const note = htmlDoc.getElementById(id);
              if (note !== null) {
                const html = processXRef(id, note);
                instance.setContent(html);
              } 
            }).finally(() => {
              instance.enable();
              instance.show();
            });
          }
        } else {
          // See if we can fetch a full url (with no hash to target)
          // This is a special case and we should probably do some content thinning / targeting
          fetch(url)
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.querySelector('main.content');
            if (note !== null) {
              // This should only happen for chapter cross references
              // (since there is no id in the URL)
              // remove the first header
              if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
                note.children[0].remove();
              }
              const html = processXRef(null, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      }, function(instance) {
      });
    }
        let selectedAnnoteEl;
        const selectorForAnnotation = ( cell, annotation) => {
          let cellAttr = 'data-code-cell="' + cell + '"';
          let lineAttr = 'data-code-annotation="' +  annotation + '"';
          const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
          return selector;
        }
        const selectCodeLines = (annoteEl) => {
          const doc = window.document;
          const targetCell = annoteEl.getAttribute("data-target-cell");
          const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
          const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
          const lines = annoteSpan.getAttribute("data-code-lines").split(",");
          const lineIds = lines.map((line) => {
            return targetCell + "-" + line;
          })
          let top = null;
          let height = null;
          let parent = null;
          if (lineIds.length > 0) {
              //compute the position of the single el (top and bottom and make a div)
              const el = window.document.getElementById(lineIds[0]);
              top = el.offsetTop;
              height = el.offsetHeight;
              parent = el.parentElement.parentElement;
            if (lineIds.length > 1) {
              const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
              const bottom = lastEl.offsetTop + lastEl.offsetHeight;
              height = bottom - top;
            }
            if (top !== null && height !== null && parent !== null) {
              // cook up a div (if necessary) and position it 
              let div = window.document.getElementById("code-annotation-line-highlight");
              if (div === null) {
                div = window.document.createElement("div");
                div.setAttribute("id", "code-annotation-line-highlight");
                div.style.position = 'absolute';
                parent.appendChild(div);
              }
              div.style.top = top - 2 + "px";
              div.style.height = height + 4 + "px";
              div.style.left = 0;
              let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
              if (gutterDiv === null) {
                gutterDiv = window.document.createElement("div");
                gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
                gutterDiv.style.position = 'absolute';
                const codeCell = window.document.getElementById(targetCell);
                const gutter = codeCell.querySelector('.code-annotation-gutter');
                gutter.appendChild(gutterDiv);
              }
              gutterDiv.style.top = top - 2 + "px";
              gutterDiv.style.height = height + 4 + "px";
            }
            selectedAnnoteEl = annoteEl;
          }
        };
        const unselectCodeLines = () => {
          const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
          elementsIds.forEach((elId) => {
            const div = window.document.getElementById(elId);
            if (div) {
              div.remove();
            }
          });
          selectedAnnoteEl = undefined;
        };
          // Handle positioning of the toggle
      window.addEventListener(
        "resize",
        throttle(() => {
          elRect = undefined;
          if (selectedAnnoteEl) {
            selectCodeLines(selectedAnnoteEl);
          }
        }, 10)
      );
      function throttle(fn, ms) {
      let throttle = false;
      let timer;
        return (...args) => {
          if(!throttle) { // first call gets through
              fn.apply(this, args);
              throttle = true;
          } else { // all the others get throttled
              if(timer) clearTimeout(timer); // cancel #2
              timer = setTimeout(() => {
                fn.apply(this, args);
                timer = throttle = false;
              }, ms);
          }
        };
      }
        // Attach click handler to the DT
        const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
        for (const annoteDlNode of annoteDls) {
          annoteDlNode.addEventListener('click', (event) => {
            const clickedEl = event.target;
            if (clickedEl !== selectedAnnoteEl) {
              unselectCodeLines();
              const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
              if (activeEl) {
                activeEl.classList.remove('code-annotation-active');
              }
              selectCodeLines(clickedEl);
              clickedEl.classList.add('code-annotation-active');
            } else {
              // Unselect the line
              unselectCodeLines();
              clickedEl.classList.remove('code-annotation-active');
            }
          });
        }
    const findCites = (el) => {
      const parentEl = el.parentElement;
      if (parentEl) {
        const cites = parentEl.dataset.cites;
        if (cites) {
          return {
            el,
            cites: cites.split(' ')
          };
        } else {
          return findCites(el.parentElement)
        }
      } else {
        return undefined;
      }
    };
    var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
    for (var i=0; i<bibliorefs.length; i++) {
      const ref = bibliorefs[i];
      const citeInfo = findCites(ref);
      if (citeInfo) {
        tippyHover(citeInfo.el, function() {
          var popup = window.document.createElement('div');
          citeInfo.cites.forEach(function(cite) {
            var citeDiv = window.document.createElement('div');
            citeDiv.classList.add('hanging-indent');
            citeDiv.classList.add('csl-entry');
            var biblioDiv = window.document.getElementById('ref-' + cite);
            if (biblioDiv) {
              citeDiv.innerHTML = biblioDiv.innerHTML;
            }
            popup.appendChild(citeDiv);
          });
          return popup.innerHTML;
        });
      }
    }
  });
  </script>
<nav class="page-navigation">
  <div class="nav-page nav-page-previous">
      <a href="./Ch-09.html" class="pagination-link" aria-label="Time series">
        <i class="bi bi-arrow-left-short"></i> <span class="nav-page-text"><span class="chapter-number">9</span>&nbsp; <span class="chapter-title">Time series</span></span>
      </a>          
  </div>
  <div class="nav-page nav-page-next">
  </div>
</nav>
</div> <!-- /content -->
<footer class="footer">
  <div class="nav-footer">
    <div class="nav-footer-left">
<p>© Copyright 2024, Dmitri Finkelshtein, Kristian Evans</p>
</div>   
    <div class="nav-footer-center">
<p>MA-M27: Lecture Notes</p>
</div>
    <div class="nav-footer-right">
<p>This page is built with <a href="https://quarto.org/">Quarto</a>.</p>
</div>
  </div>
</footer>




</body></html>